<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>APM-使用Eclipse进行ArduPilot Mega开发</title>
  <meta name="author" content="liung">



  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="http://liung.github.io/favicon.png" rel="icon">
  <link href="http://liung.github.io/theme/css/main.css" media="screen, projection"
        rel="stylesheet" type="text/css">
  <script src="http://liung.github.io/theme/js/modernizr-2.0.js"></script>
  <script src="http://liung.github.io/theme/js/ender.js"></script>
  <script src="http://liung.github.io/theme/js/octopress.js" type="text/javascript"></script>

  <link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="http://liung.github.io/">折返的Liung</a></h1>
    <h2>我如溪水，静静流淌在山涧~~我如白云，俯瞰此生今生~~</h2>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
</ul>


<form action="//google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:liung.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>

<ul class="main-navigation">
    <li><a href="/archives.html">目  录</a></li>
    <li><a href="http://liung.github.io">主  页</a></li>
</ul></nav>
  <div id="main">
    <div id="content">
<div>
  <article class="hentry" role="article">
<header>
      <h1 class="entry-title">APM-使用Eclipse进行ArduPilot Mega开发</h1>
      <p class="meta"><time datetime="2014-10-16T13:54:19+08:00" pubdate>Oct 16, 2014</time></p>
</header>

  <div class="entry-content"><h3>综述</h3>


<ol>
<li>Eclipse是一款精致地多语言集成开发平台</li>
<li>Eclipse CDT（C++开发工具）实现了支持在Eclipse平台进行C/C++开发</li>
<li>Eclipse CDT工具可以帮助管理与组织大型C++工程，比如ArduPilot Mega的固件开发工程</li>
<li>本指南用来说明如何将最近的ArduPilot Mega 固件开发工程设置为Eclipse CDT工程</li>
<li>提醒：这些操作都在Eclipse Kepler（4.3.0）版本上进行。</li>
</ol>


<hr>
<h3>当前编译相关信息</h3>
<ol>
<li>基于make的编译系统支持在Windows，MacOS，Liunx平台进行APM编译</li>
<li>但是，你仍然可以使用安装的Arduino IDE进行，因为在编译过程中也使用到了它的工具链的一部分</li>
<li>位于ardupilot-mega工程文件顶层目录的文件README.txt记录了编译说明相关信息</li>
<li>在Readme.txt文件中关于使用Eclipse的编译说明仍然可以使用，但是相对复杂一些</li>
</ol>
<hr>
<h3>安装Eclipse和CDT组件</h3>
<p>如果你已经安装了Eclipse，但是没有安装CDT组件，那么你可以直接跳到下一部分内容。</p>
<ul>
<li>下载并安装最新版本的<a href="http://java.com/en/download/index.jsp">Java Runtime Environment（Java运行时环境）</a></li>
<li>对于C/C++开发者下载并安装最新版本的Eclipse IDE。</li>
</ul>
<p>A.前往<a href="http://www.eclipse.org/downloads/">下载页面</a></p>
<p>B.在“安装包选型”中点击“Eclipse IDE for C/C++ Developer”</p>
<ul>
<li>将下载的压缩包解压到你的桌面上。</li>
</ul>
<p><img alt="1" src="http://dev.ardupilot.com/wp-content/uploads/sites/6/2013/08/ExtractEclipse1.png"></p>
<p><img alt="2" src="http://dev.ardupilot.com/wp-content/uploads/sites/6/2013/08/ExtractDesktop1.png"></p>
<p><img alt="3" src="http://dev.ardupilot.com/wp-content/uploads/sites/6/2013/08/ExtractToDesktop1.png"></p>
<ul>
<li>如果Eclipse不能正常运行并弹出“不能找到Java JDK or JRE”相关信息，请阅读<strong>问题排查</strong>部分内容</li>
</ul>
<hr>
<h3>在Eclipse安装程序中添加C开发工具</h3>
<ul>
<li>如果你按照上一部分的说明下载了Eclipse，那么你可以跳过该部分</li>
</ul>
<p>A.因为你安装的Eclipse中已经带有CDT组件</p>
<ul>
<li>如果你还没有加载C开发工具（或者还不能够正确加载）</li>
</ul>
<p>A. 前往<a href="http://www.eclipse.org/cdt/downloads.php">http://www.eclipse.org/cdt/downloads.php</a>的<strong>CDT 8.2.0 for Eclipse Kepler</strong>部分</p>
<p>B. 运行Eclipse 工程，选择<strong>Windows</strong>下拉菜单中的<strong>参数（Preference）</strong>选项</p>
<p><img alt="4" src="http://dev.ardupilot.com/wp-content/uploads/sites/6/2013/08/Eclipse-Preferences.png"></p>
<ul>
<li>单击参数窗口的<strong>Install/Unpdate</strong>左侧小三角箭头，选择<strong>可用站点（Availabel Sorftware Sites）</strong>，然后选择添加按钮</li>
</ul>
<p>A.在添加站点（<strong>Add Site</strong>）窗口的<strong>Name</strong>栏键入<strong>CDT</strong></p>
<p>B.然后从CDT的下载页面复制URL链接<strong>http://download.eclipse.org/tools/cdt/releases/kepler</strong>到<strong>Location</strong>栏</p>
<p>C.在添加站点（<strong>Add Site</strong>）窗口点击<strong>OK</strong>，然后在<strong>参数（Preference）</strong>窗口点击<strong>OK</strong></p>
<p><img alt="5" src="http://dev.ardupilot.com/wp-content/uploads/sites/6/2013/08/EclipseLoadCDT.png"></p>
<hr>
<h3>创建工作空间</h3>
<ul>
<li>运行Eclipse：</li>
</ul>
<p>A.导航到桌面的Eclipse目录</p>
<p>B.双击eclipse.exe</p>
<ul>
<li>当Eclipse窗口打开：</li>
</ul>
<p>A.选择<strong>Window</strong>菜单项中的<strong>Preference</strong>选项</p>
<p>B.在<strong>Preference</strong>窗口点击<strong>C/C++</strong>的左侧箭头，然后选择<strong>File Types</strong></p>
<p>C.如果列表中没有“*.pde”条目，使用<strong>New</strong>按钮打开<strong>C/C++文件类型</strong>窗口</p>
<p>D.在<strong>Pattern</strong>栏键入<strong><em>.pde</em>*，在</strong>Type<strong>下拉选项中选择</strong>C++ Source File**</p>
<p>E.在<strong>C/C++ File Type</strong>窗口点击<strong>OK</strong>，然后点击<strong>Preference</strong>窗口的<strong>OK</strong>按钮</p>
<p>F.这样就解决了Eclipse中pde文件与C++的关联</p>
<p><img alt="6" src="http://dev.ardupilot.com/wp-content/uploads/sites/6/2013/08/EclipsePrefPDE.png"></p>
<ul>
<li>Eclipse的代码分析功能不能够正确的解析arduino的.pde文件。为了避免编辑arduino代码时出现上百个“undeclared（未声明）”和“unused（未使用）”错误信息，禁用代码解析带来的错误</li>
</ul>
<p>A.选择<strong>Window</strong>菜单项中的<strong>Preference</strong>选项</p>
<p>B.点击<strong>C/C++</strong>选项卡左侧的小三角展开内容，选择<strong>Code Analysis</strong></p>
<p>C.取消选中<strong>Syntax and Semantic Errors</strong>，然后点击<strong>OK</strong>按钮</p>
<p><img alt="7" src="http://dev.ardupilot.com/wp-content/uploads/sites/6/2013/08/UntitledEclipsePrefTurnOffErrors.png"></p>
<hr>
<h3>创建Ardupilot Mega工程</h3>
<p><strong>1、</strong>运行<strong>Eclipse</strong>软件，单击左上方的<strong>File</strong>菜单，在下拉菜单中选择<strong>Import</strong>选项。</p>
<p><strong>2、</strong>在<strong>Import</strong>窗口，通过点击C/C++左边的小三角展开选项。</p>
<p><strong>3、</strong>选择<strong>Existing Code as Makefile Project</strong>（译者注：某些版本的Eclipse，可能是<strong>Makefile Project with Existing Code</strong>），点击<strong>Next</strong>按钮进入导入代码选项窗口。</p>
<p><img alt="8" src="http://dev.ardupilot.com/wp-content/uploads/sites/6/2013/08/EclipseSelectExistCodeAsMake.png"></p>
<p><strong>4、</strong>在<strong>New Project</strong>的文件导航窗口，选择ardupilot-mega代码的顶层目录到<strong>Existing Code Location</strong>文本栏，然后点击<strong>Finish</strong>按钮。</p>
<p><img alt="9" src="http://dev.ardupilot.com/wp-content/uploads/sites/6/2013/08/EclipseImportArduPilot.png"></p>
<p><strong>5、</strong>为了针对你特定类型的载具和飞控板类型编译相应代码，需要对编译配置进行更改。</p>
<p><strong>A、</strong>选择Eclipse软件页面左上侧的如Java页面部件的菜单项（打开视图窗口）。</p>
<p><strong>B、</strong>在弹出的视图窗口中选择<strong>C/C++(default)</strong>项，点击<strong>OK</strong>按钮。</p>
<p><strong>C、</strong>在工程管理器页面你的工程（下图的<strong>ardupilot-master</strong>）上右击</p>
<p><img alt="10" src="http://dev.ardupilot.com/wp-content/uploads/sites/6/2013/08/EclipseOpenPerspectiveCC++.png"></p>
<p><strong>6、</strong>在弹出菜单中选择<strong>Properties</strong></p>
<p><strong>7、</strong>属性窗口（Properties）选择<strong>C/C++ Build</strong>（当前选项卡应该是<strong>Builder Settings</strong>）</p>
<p><strong>8、</strong>在<strong>C/C++ Build</strong>窗口，编辑<strong>Build directory</strong>文本栏内容为你想要编译的载具目录。</p>
<p>A、例如，将<code>${workspace_loc:/ardupilot-master}</code>变为<code>${workspace_loc:/ardupilot-master/ArduPlane}</code></p>
<p><img alt="11" src="http://dev.ardupilot.com/wp-content/uploads/sites/6/2013/08/EclipseBuildSettings.png"></p>
<p><strong>9、</strong>现在，选择<strong>Behavior</strong>选项卡</p>
<p><strong>10、</strong>在<strong>Build（Incremental Build）</strong>项，用你的编译目标（编译参数）替换<strong>all</strong>，如果你想编译近期的APM飞控板，那么可以改为<strong>apm2</strong></p>
<p><strong>11、</strong>这里还可以填写其他的编译目标（编译参数），包括SIL和各种旋翼构型</p>
<p><strong>12、</strong>可以在不同飞行器目录中的Makefiles文件中查看可用的参数类型（目标类型）</p>
<p><strong>13、</strong>最后点击<strong>C/C++ Build</strong>窗口底部的<strong>OK</strong>按钮</p>
<p><img alt="12" src="http://dev.ardupilot.com/wp-content/uploads/sites/6/2013/08/EclipseSetBuildTarget.png"></p>
<hr>
<h3>编译ArduPilot工程</h3>
<hr>
<h3>可用插件</h3>
<p>1、<strong>AVR Eclipse 插件</strong>可能在Eclipse中进行APM编程非常有用</p>
<p>A、 现在，它在窗口底部区域添加了一个AVR Device管理器，有助于找到AVR注册者的相关名称</p>
<p>2、<strong>EGit插件</strong>能够在Eclipse进行版本控制，并允许你尽可能的在不脱离IDE的情况下对代码进行升级、比较和提交操作</p>
<hr>
<h3>问题排查</h3>
<p>1、当启动Eclipse时得到“不能找到Java JRE或者JDK”相关错误信息，你需要编辑Eclipse.ini配置文件，设置Java安装包的正确路径</p>
<p>2、定位到你的Java安装位置，可能位于：<strong>C:/program files/java/jdk1.7.0_07/bin/java</strong></p>
<p>3、用文本编辑器，如NotePad++，代开Eclipse.ini配置文件，添加Java安装路径到出现<strong>-vm</strong>的下一行</p>
<p><img alt="13" src="http://dev.ardupilot.com/wp-content/uploads/sites/6/2013/08/JavaPathInEclipseIni.png"></p>
<p>4、编辑完成后保存<strong>Eclipse.ini</strong>文件，然后点击<strong>Eclipse.exe</strong>重启Eclipse</p>
<p>5、（在完成编辑Eclipse.ini文件，启动Eclipse之前可能还需要重启电脑）</p>
<hr>
<h4>链接</h4>
<ol>
<li><a href="http://dev.ardupilot.com/wiki/editing-the-code-with-eclipse/">APM官网原文链接</a></li>
<li><a href="http://liung.github.io/blog/apm/2014-08-29-APM-开发人员参考手册目录列表.html">APM开发人员参考手册目录列表</a></li>
</ol>
<p><em>(over)</em></p></div>
    <footer>
<p class="meta">
  <span class="byline author vcard">
    Posted by <span class="fn">liung</span>
  </span>
<time datetime="2014-10-16T13:54:19+08:00" pubdate>Oct 16, 2014</time>  <span class="categories">
    <a class="category" href="http://liung.github.io/tag/apm.html">APM</a>
    <a class="category" href="http://liung.github.io/tag/fei-kong-ban.html">飞控板</a>
    <a class="category" href="http://liung.github.io/tag/ying-jian.html">硬件</a>
  </span>
</p><div class="sharing">
</div>    </footer>
  </article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
  </section>
</div>
<aside class="sidebar">
  <section>
	  <img src="http://liung.github.io/images/author_photo.jpg" alt="Liung" width="300"/> 
  </section>
  <section>
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
          <a href="http://liung.github.io/blog/apm/2015-04-01-APM-MissionPlanner的仿真界面.html">MissionPlanner-仿真界面分析</a>
      </li>
      <li class="post">
          <a href="http://liung.github.io/blog/qi-dong/2015-03-24-由压力系数计算升力系数.html">升力系数的计算</a>
      </li>
      <li class="post">
          <a href="http://liung.github.io/blog/apm/2015-02-15-APM-使用命令行界面.html">APM-使用命令行界面</a>
      </li>
      <li class="post">
          <a href="http://liung.github.io/blog/apm/2015-02-14-APM-使用调试终端与APM交互.html">APM-使用调试终端与APM交互</a>
      </li>
      <li class="post">
          <a href="http://liung.github.io/blog/apm/2015-02-14-APM-串口输出.html">APM-串口输出</a>
      </li>
    </ul>
  </section>
  <section>
      
    <h1>Categories</h1>
    <ul id="recent_posts">
        <li><a href="http://liung.github.io/category/apm/index.html">APM</a></li>
        <li><a href="http://liung.github.io/category/fei-xing-qi/index.html">飞行器</a></li>
        <li><a href="http://liung.github.io/category/python/index.html">Python</a></li>
        <li><a href="http://liung.github.io/category/qi-dong/index.html">气动</a></li>
        <li><a href="http://liung.github.io/category/qi-ta/index.html">其它</a></li>
    </ul>
  </section>
 

  <section>
  <h1>Tags</h1>
    <a href="http://liung.github.io/tag/apm.html">APM</a>,    <a href="http://liung.github.io/tag/mp.html">MP</a>,    <a href="http://liung.github.io/tag/qi-dong.html">气动</a>,    <a href="http://liung.github.io/tag/cli.html">CLI</a>,    <a href="http://liung.github.io/tag/terminal.html">Terminal</a>,    <a href="http://liung.github.io/tag/serial.html">Serial</a>,    <a href="http://liung.github.io/tag/git.html">Git</a>,    <a href="http://liung.github.io/tag/github.html">GitHub</a>,    <a href="http://liung.github.io/tag/mavlink.html">MAVLink</a>,    <a href="http://liung.github.io/tag/mission-planner.html">Mission Planner</a>,    <a href="http://liung.github.io/tag/fei-kong-ban.html">飞控板</a>,    <a href="http://liung.github.io/tag/ying-jian.html">硬件</a>,    <a href="http://liung.github.io/tag/qi-dong-ruan-jian.html">气动软件</a>,    <a href="http://liung.github.io/tag/python.html">python</a>,    <a href="http://liung.github.io/tag/ipython.html">ipython</a>,    <a href="http://liung.github.io/tag/pandas.html">pandas</a>,    <a href="http://liung.github.io/tag/numpy.html">Numpy</a>,    <a href="http://liung.github.io/tag/apmcopter.html">APM:Copter</a>,    <a href="http://liung.github.io/tag/c.html">C++</a>,    <a href="http://liung.github.io/tag/bo-ke.html">博客</a>  </section>


    <section>
        <h1>Social</h1>
        <ul>
            <li><a href="http://www.weibo.com" target="_blank">新浪微博</a></li>
            <li><a href="https://github.com/Liung" target="_blank">Github</a></li>
        </ul>
    </section>
    <section>
        <h1>Blogroll</h1>
        <ul>
            <li><a href="http://google.com/" target="_blank">Google</a></li>
            <li><a href="http://python.org/" target="_blank">Python.org</a></li>
            <li><a href="http://getpelican.com/" target="_blank">Pelican</a></li>
        </ul>
    </section>

</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
    Copyright &copy;  2012-2015  - liung -
  <!--
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
  -->
  <span class="credit">一个执拗的完美主义者</a></span>
</p></footer>
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-54228593-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-54228593-1');
    ga('send', 'pageview');
</script>
	<script type="text/javascript">
	  var disqus_shortname = 'liunggithubio-aerodynamic';
          var disqus_identifier = '/blog/apm/2014-10-16-APM-使用Eclipse编辑代码.html';
          var disqus_url = 'http://liung.github.io/blog/apm/2014-10-16-APM-使用Eclipse编辑代码.html';
          var disqus_title = 'APM-使用Eclipse进行ArduPilot Mega开发';
	  (function() {
	    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	    dsq.src = "//" + disqus_shortname + '.disqus.com/embed.js';
	    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	   })();
	</script>
</body>
</html>